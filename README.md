
# Inpainterz
-------------------------------
Online Demo: (colab link), Project presentation: (team ppt)


**Inpainterz**ëŠ” 2023ë…„ ì´ì–´ë“œë¦¼ìŠ¤ì¿¨3ê¸°ì—ì„œ ì§„í–‰ëœ ê¸°ì—…ì—°ê³„ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤. 
ì–´ëŠ ê¸°ì—…ìœ¼ë¡œ ë¶€í„° ì¸í˜ì¸íŒ… ê¸°ìˆ ì— ëŒ€í•œ ì„ í–‰ì—°êµ¬ê°œë°œ ì£¼ì œë¥¼ ë°›ê²Œ ë˜ì–´ ì§„í–‰í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

ğŸš€ Team Members
> [ê°•ë„ì„±]() 
> [ê²½ì†Œí˜„]() 
> [ë³€ì›…ì§„]()
> [ì†ìˆ˜ì§„]()
> [ì§€ê²½í˜¸]()

ê·¸ ê²°ê³¼ë¥¼ ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸ë¡œ ì •ë¦¬í–ˆìŠµë‹ˆë‹¤. ì£¼ìš” ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œëŠ” ì œë¡œìƒ· ëŸ¬ë‹ ë° ë¹„ì ¼ì—ì„œì˜ íŒŒìš´ë°ì´ì…˜ ëª¨ë¸ë¡œ ì„ ë³´ì¸ Metaì˜ [**SAM**(Segment Anything Models)](https://github.com/facebookresearch/segment-anything) ê³¼ íš¨ìœ¨ì ì¸ Multi-Object Track ê·¸ë¦¬ê³  Propagationë¥¼ ìœ„í•œ [**DeAOT**(Decoupling features in Associating Objects with Transformers)](https://github.com/yoxu515/aot-benchmark)(NeurIPS2022)ê·¸ë¦¬ê³  [**E2FGVI** (End-to-End Framework for Flow-Guided Video Inpainting)](https://github.com/MCG-NKU/E2FGVI) ìœ¼ë¡œ ì¸í˜ì¸íŒ…ì„ í•˜ëŠ” Workflowì´ë©° gradioë¥¼ ì´ìš©í•´ êµ¬ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.

ë¹„ë””ì˜¤ë¥¼ ì¸í˜ì¸íŒ… í•˜ëŠ” ê³¼ì •ì€ ë‹¤ìŒê³¼ ê°™ì´ ì •ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. *ë™ì˜ìƒ ë§ˆìŠ¤í‚¹*
   **Segmentation** & **Masking**
   ë™ì˜ìƒì—ì„œ ì¸í˜ì¸íŒ…í•  ê°ì²´ë¥¼ ì„ íƒí•˜ê³  ì •í™•í•˜ê²Œ íŒë³„(ë¶„ë¦¬)í•˜ê¸° ìœ„í•´, Segmentation ê¸°ë²•ì„ ì‚¬ìš©.Â 
   í•´ë‹¹ ë¶€ë¶„ì´ ëˆ„ë½ëœ ê²ƒì²˜ëŸ¼ ë¶„í• ëœ ê°ì²´ë¥¼ Maskingí•˜ì—¬, ì¸í˜ì¸íŒ… ì•Œê³ ë¦¬ì¦˜ì´ ìˆ˜í–‰í•  ìˆ˜ ìˆê²Œ í•œë‹¤.Â 
   **Tracking**, use **Long-term Memory**
   Long-term Memoryìœ¼ë¡œ Maskingëœ ê°ì²´ê°€ íŠ¹ì • í”„ë ˆì„ ë‚´ì—ì„œ ë”°ë¼ ì›€ì§ì´ëŠ” ê²ƒì„ ì—°ì†ì ìœ¼ë¡œ Tracking & Maskingì„ ìˆ˜í–‰í•˜ì—¬ ë™ì˜ìƒ ë‚´ì— ëª¨ë“  ë§ˆìŠ¤í‚¹ ì´ë¯¸ì§€ë¥¼ ì¶”ì¶œí•œë‹¤.Â 
   
2. *ë™ì˜ìƒ ì¸í˜ì¸íŒ…*
   **Inpainting**
   Input ê°’ìœ¼ë¡œ Maskingëœ ì˜ìƒì„ ë„£ìœ¼ë©´ ë³µì›í•´ì•¼í•˜ëŠ” ëˆ„ë½ëœ ì§€ì ìœ¼ë¡œ ì¸ì‹í•œë‹¤. ì´ ê³¼ì •ì—ì„œ ì•Œê³ ë¦¬ì¦˜ì€ ì£¼ë³€ì˜ í”½ì…€ ì •ë³´ë¡œ ëˆ„ë½ëœ ë¶€ë¶„ì˜ ìƒ‰ìƒê³¼ í…ìŠ¤ì²˜ ë“±ì„ ì¶”ì •í•˜ê³  ì±„ìš´ë‹¤.Â 

3. *ê²°ê³¼ í™•ì¸ ë° ìˆ˜ì •*
   Inpaintingëœ ê²°ê³¼ë¥¼ í™•ì¸í•˜ê³ , í’ˆì§ˆì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´ ì¶”ê°€ì ì¸ Taskë¥¼ ìˆ˜í–‰í•œë‹¤.


**inpainterzì˜ íŒŒì´í”„ë¼ì¸**ì€ **SAM**ì´ ìƒˆë¡œìš´ ì˜¤ë¸Œì íŠ¸ë¥¼ ë™ì ìœ¼ë¡œ ìë™ê°ì§€í•˜ê³  ì„¸ë¶„í™”í•  ìˆ˜ ìˆë„ë¡ ì§€ì›í•˜ë©°, **DeAOT**ëŠ” ì‹ë³„ëœ ëª¨ë“  ì˜¤ë¸Œì íŠ¸ë¥¼ ì¶”ì í•˜ëŠ” ì—­í• ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤. ê²°ê³¼ì ìœ¼ë¡œ **E2FGVI**ëŠ” ì¶”ì ë˜ì–´ ë§ˆìŠ¤í‚¹ëœ ë¹„ë””ì˜¤ ì˜ìƒë“¤ì„ ì¸í˜ì¸íŒ… í•©ë‹ˆë‹¤. 

![[readme00.png]]


## **Summary** of the algorithms used
---------
**inpainterz**ì—ì„œ ì‚¬ìš©í•œ ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•œ ë‚´ìš©ì„ ìš”ì•½í–ˆìŠµë‹ˆë‹¤. 
### SAM 
(Segment Anything Model) **[Paper](https://ai.meta.com/research/publications/segment-anything/)**
ëŒ€ê·œëª¨ ë°ì´í„°ì…‹ì´ êµ¬ì¶•ë˜ì§€ ì•Šì•˜ë˜ ê¸°ì¡´ì˜ Segmentation ì‘ì—…ì€ ë§¤ë²ˆ í•™ìŠµì— ì†Œëª¨ë˜ëŠ” ì‹œê°„ê³¼ ë¹„ìš©ì´ ë„ˆë¬´ í¬ë‹¤ëŠ” ë¬¸ì œê°€ ìˆì—ˆë‹¤. NLP ë¶„ì•¼ì˜ LLMì²˜ëŸ¼, **Zero-shot**ì´ ê°€ëŠ¥í•œ ëª¨ë¸ì„ ë§Œë“¤ìˆ˜ ì—†ì„ê¹Œ í–ˆê³ , 2023ë…„ 4ì›” Metaì—ì„œ Image Segmentationê³„ì˜ **Foundation** ëª¨ë¸ì„ ë§Œë“œëŠ” ê²ƒì„ ëª©í‘œë¡œ í”„ë¡œì íŠ¸ë¥¼ ë°œí‘œí–ˆë‹¤.

MetaëŠ” ë‹¤ìŒ ì„¸ ê°€ì§€ë¥¼ ìƒˆë¡­ê²Œ ì„ ë³´ì˜€ë‹¤. **Task**, **Model**, **Data**.
1. **Task** ( Promptable Segmentation Task )
	Segment Anything Taskì˜ í•µì‹¬ì€ **í”„ë¡¬í”„íŒ…ì´ ê°€ëŠ¥**í•˜ë‹¤ëŠ” ê²ƒì´ë‹¤.
	ì›í•˜ëŠ” ì˜ì—­ì˜ **Point**ë‚˜ **Box** ë˜ëŠ” **ìì—°ì–´**, (+ **Mask**)ë¡œ êµ¬ì„±ëœ í”„ë¡¬í”„íŠ¸ë¥¼ ì…ë ¥í•˜ë©´, ì•„ë¬´ë¦¬ ëª¨í˜¸í•œ ì •ë³´ì¼ì§€ë¼ë„ ìœ íš¨í•œ Segmentation Maskë¥¼ ì¶œë ¥í•œë‹¤.
	![[readme01.png]]
2. **Model** ( Segment Anything Model, SAM )
	ì´ë¥¼ ìœ„í•œ ëª¨ë¸ì¸ SAMì€ **ë‘ ê°œì˜ ì¸ì½”ë”**ì™€ **í•˜ë‚˜ì˜ ë””ì½”ë”**ë¡œ êµ¬ì„±ëœë‹¤.
	Image Encoderì™€ Prompt Encoderë¡œë¶€í„° ì˜¨ ì„ë² ë”© ì •ë³´ë¥¼ ë§¤í•‘í•´ Mask Decoderê°€ ì˜ˆì¸¡ëœ Segmentation Maskë¥¼ ì¶œë ¥í•˜ëŠ” êµ¬ì¡°ë‹¤. 
	
	Mask DecoderëŠ” Transformerì˜ Decoderë¥¼ ì¡°ê¸ˆ ìˆ˜ì •í•œ ê²ƒìœ¼ë¡œ, ì´ë¯¸ì§€ ì„ë² ë”©ê³¼ í”„ë¡¬í”„íŠ¸ ì„ë² ë”©ì„ ëª¨ë‘ ì—…ë°ì´íŠ¸ í•˜ê¸° ìœ„í•´ **Self-Attention**ê³¼ **Cross-Attention**ì„ ì–‘ë°©í–¥ìœ¼ë¡œ í™œìš©í•œë‹¤.
	
	SAMì˜ Prompt Encoderì™€ Mask DecoderëŠ” **ê°€ë³ê³  ë¹ ë¥´ë‹¤**.
	ê°™ì€ ì´ë¯¸ì§€ ì„ë² ë”©ì´ ì—¬ëŸ¬ ê°œì˜ í”„ë¡¬í”„íŠ¸ì™€ í•¨ê»˜ ì¬ì‚¬ìš©ë˜ê¸° ë•Œë¬¸ì—, CPU í™˜ê²½ì˜ ì›¹ ìƒì—ì„œ 50ms ì´í•˜ì˜ ì†ë„ë¡œ Maskë¥¼ ì˜ˆì¸¡í•  ìˆ˜ ìˆë‹¤.
	![[readme02.mp4]]
	 >
3. **Data** ( Segment Anythin Data Engine, SA-1B Dataset )
	Foundation ëª¨ë¸ ê°œë°œì— ìˆì–´ ê°€ì¥ ì¤‘ìš”í•œ ê²ƒì€ ëŒ€ê·œëª¨ ë°ì´í„°ì…‹ì´ë‹¤.
	Segment Anythingì€ ìì²´ì ì¸ **Data Engine**ì„ ê°œë°œí–ˆê³ , ê·¸ ê²°ê³¼ 10ì–µ ê°œì˜ Maskë¥¼ ê°€ì§„ **SA-1B** ë°ì´í„°ì…‹ì´ íƒ„ìƒí–ˆë‹¤.
	![[readme03.png]]

### DeAOT
(Decoupling features in Associating Objects with Transformers) [**Paper**](https://arxiv.org/abs/2210.09782)

1. ê¸°ì¡´ì˜ AOT ë°©ë²•ì„ ê°œì„ í•˜ì—¬, ê°ì²´ì— êµ¬ì• ë°›ì§€ ì•ŠëŠ” ì‹œê°ì , ê°ì²´ë³„ íŠ¹ì§•ì„ ë…ë¦½ì ì¸ ë‘ ë¶„ê¸°ì—ì„œ ì²˜ë¦¬, dual independent branches propagationë¥¼ ìœ„í•œ íš¨ìœ¨ì ì¸ ëª¨ë“ˆì¸ Gated Propagation Module (GPM)ì„ ë„ì…í•˜ì—¬ hierarchical propagationì„ êµ¬ì„±í•©ë‹ˆë‹¤â€‹â€‹.

1. **VOSì˜ ì •ì˜ì™€ ë°°ê²½**
	VOSëŠ” ì£¼ì–´ì§„ ë¹„ë””ì˜¤ì—ì„œ í•˜ë‚˜ ë˜ëŠ” ì—¬ëŸ¬ ê°ì²´ë¥¼ ì¸ì‹í•˜ê³  ë¶„í• í•˜ëŠ” ì¤‘ìš”í•œ ë¹„ë””ì˜¤ ì´í•´ ì‘ì—…ì…ë‹ˆë‹¤. ì´ ì—°êµ¬ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ ì´ˆê¸° í”„ë ˆì„ì—ì„œ ì£¼ì–´ì§„ ê°ì²´ì˜ ë§ˆìŠ¤í¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì „ì²´ ë¹„ë””ì˜¤ ì‹œí€€ìŠ¤ì— ê±¸ì³ ê°ì²´ë¥¼ ì¶”ì í•˜ê³  ë¶„í• í•´ì•¼ í•˜ëŠ” ë°˜ê°ë… VOSì— ì¤‘ì ì„ ë‘¡ë‹ˆë‹¤â€‹â€‹.

2. **DeAOTì˜ ì£¼ìš” êµ¬ì„±**
	DeAOTëŠ” ë‘ ê°€ì§€ ë¶„ê¸°, ì¦‰ ì‹œê°ì  ë¶„ê¸°ì™€ ID ë¶„ê¸°ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. ì‹œê°ì  ë¶„ê¸°ëŠ” ê°ì²´ë¥¼ ì¼ì¹˜ì‹œí‚¤ê³  ê³¼ê±°ì˜ ì‹œê° ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ë©° ê°ì²´ íŠ¹ì§•ì„ ì •ì œí•˜ëŠ” ì—­í• ì„ í•©ë‹ˆë‹¤. ID ë¶„ê¸°ëŠ” ì‹œê°ì  ë¶„ê¸°ì—ì„œ ê³„ì‚°ëœ ì¼ì¹˜ ë§µ(ì£¼ì˜ ë§µ)ì„ ì¬ì‚¬ìš©í•˜ì—¬ ê³¼ê±° í”„ë ˆì„ì—ì„œ í˜„ì¬ í”„ë ˆì„ìœ¼ë¡œ ID ì„ë² ë”©ì„ ì „íŒŒí•©ë‹ˆë‹¤â€‹â€‹.

4. **Gated Propagation Module (GPM)**: DeAOTì—ì„œëŠ” íš¨ìœ¨ì„±ì„ ë†’ì´ê¸° ìœ„í•´ ë‹¨ì¼ í—¤ë“œ ì£¼ì˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì„¤ê³„ëœ GPMì„ ì‚¬ìš©í•©ë‹ˆë‹¤. GPMì€ ìì²´ ì „íŒŒ, ì¥ê¸° ì „íŒŒ, ë‹¨ê¸° ì „íŒŒì˜ ì„¸ ê°€ì§€ ì¢…ë¥˜ì˜ ê²Œì´íŠ¸ ì „íŒŒë¥¼ í¬í•¨í•©ë‹ˆë‹¤â€‹â€‹.

1. **ë„¤íŠ¸ì›Œí¬ ì„¸ë¶€ ì‚¬í•­ê³¼ íŠ¸ë ˆì´ë‹**: DeAOTëŠ” ë‹¤ì–‘í•œ ì¸ì½”ë”ì™€ ë™ì¼í•œ FPN ë””ì½”ë”ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. GPM ëª¨ë“ˆì€ ì‹œê°ì  ë° ID ì„ë² ë”©ì˜ ì°¨ì›ì„ ì§€ì •í•˜ê³ , í•™ìŠµì€ ì •ì  ì´ë¯¸ì§€ ë°ì´í„°ì…‹ì—ì„œ ìƒì„±ëœ í•©ì„± ë¹„ë””ì˜¤ ì‹œí€€ìŠ¤ì™€ VOS ë²¤ì¹˜ë§ˆí¬ì—ì„œ ìˆ˜í–‰ë©ë‹ˆë‹¤â€‹â€‹.
2. **ê²°ë¡ **: DeAOTëŠ” ê³„ì¸µì  VOS ì „íŒŒë¥¼ ìœ„í•œ íš¨ìœ¨ì ì¸ í”„ë ˆì„ì›Œí¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ëŠ” ê³„ì¸µì  ì „íŒŒì—ì„œ ì‹œê°ì  ë° ID ì„ë² ë”©ì„ ë¶„ë¦¬í•˜ì—¬ ê¹Šì€ ì „íŒŒ ê³„ì¸µì—ì„œì˜ ì‹œê° ì •ë³´ ì†ì‹¤ì„ ë°©ì§€í•©ë‹ˆë‹¤. ë˜

### E2FGVI
(End-to-End Framework for Flow-Guided Video Inpainting) [**Paper**](https://arxiv.org/abs/2204.02663)

**ë¹„ë””ì˜¤ ì¸í˜ì¸íŒ…**
ëª¨ë¸ì˜ ëª©í‘œëŠ” ë¹„ë””ì˜¤ í´ë¦½ ì „ì²´ì—ì„œ â€˜ì†ìƒëœâ€™ ì˜ì—­ì„ ê·¸ëŸ´ë“¯í•˜ê³  ì¼ê´€ëœ ì½˜í…ì¸ ë¡œ ì±„ìš°ëŠ” ê²ƒ, í•˜ì§€ë§Œ ë‚¨ì€ ê³¼ì œë¡œë³µì¡í•œ ë¹„ë””ì˜¤ ì‹œë‚˜ë¦¬ì˜¤ì™€ ì €í•˜ëœ ë¹„ë””ì˜¤ í”„ë ˆì„ì— ê´€í•œ ë¬¸ì œê°€ ìˆë‹¤. ì´ëŠ” ê³ í’ˆì§ˆ ë¹„ë””ì˜¤ ì¸í˜ì¸íŒ…ì„ ìœ„í•´ì„œëŠ” **ê³µê°„ì  êµ¬ì¡°**ì™€ **ì‹œê°„ì  ì¼ê´€ì„±**ì„ ëª¨ë‘ ê³ ë ¤í•´ì•¼ í•¨ì„ ì˜ë¯¸í•œë‹¤.

**Flow-based methods** (ê¸°ì¡´ ë°©ë²•)
- ì´ëŸ° ì¼ë°˜ì ì¸ íë¦„ê¸°ë°˜ ë°©ë²•(flow-based method)ëŠ” ì¸í˜ì¸íŒ…ì„ **pixel propagation** ë¬¸ì œë¡œ ìƒê°í•˜ì—¬ ì‹œê°„ì  ì¼ê´€ì„±ì„ ìì—°ìŠ¤ëŸ½ê²Œ ë³´ì¡´
    1. flow completion(íë¦„ ì™„ì„±) : ì†ìƒëœ ì˜ì—­ì— flow field ê°€ ì—†ìœ¼ë©´ í›„ìì˜ í”„ë¡œì„¸ìŠ¤ì— ì˜í–¥ì„ ë¯¸ì¹˜ë¯€ë¡œ ë¨¼ì € ì¶”ì •ëœ optical flowê°€ ë¨¼ì € ì™„ë£Œ(complete) ë˜ì–´ì•¼ í•¨
    2. pixel propagation(í”½ì…€ ì „íŒŒ) : ì•ì„œ ì™„ì„±ëœ optical flowì˜ ê°€ì´ë“œ(ì•ˆë‚´)ì— ë”°ë¼ ê°€ì‹œì˜ì—­ì˜ í”½ì…€ì„ ì–‘ë°©í–¥ìœ¼ë¡œ ì „íŒŒí•´ ì†ìƒëœ ë¹„ë””ì˜¤ì˜ ì˜ì—­ì„ ì±„ì›€
    3. content hallucination(ì½˜í…ì¸  í™˜ê°) : í”½ì…€ ì „íŒŒ í›„, ë‚˜ë¨¸ì§€ ëˆ„ë½ëœ ì˜ì—­ì€ ì‚¬ì „ í•™ìŠµëœ ì´ë¯¸ì§€ ì¸í˜ì¸íŒ… ë„¤íŠ¸ì›Œí¬ë¡œ í™˜ê°ìœ¼ë¡œ ì±„ì›€
-  ì¸í˜ì¸íŒ…ì˜ ë°©ë²•ì€ ì „ì²´ ì¸í˜ì¸íŒ… íŒŒì´í”„ë¼ì¸ì„ êµ¬ì„±í•˜ê¸° ìœ„í•´ ê°œë³„ì ìœ¼ë¡œ ì ìš©, ì¸ìƒì ì¸ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆì§€ë§Œ, ì²˜ìŒ ë‘ ë‹¨ê³„ì—ì„œëŠ” ë§ì€ ìˆ˜ì‘ì—…ì´ í•„ìš”í•´ì„œ, **ê° í”„ë¡œì„¸ìŠ¤ëŠ” ë³„ë„ë¡œ ìˆ˜í–‰**í•´ì•¼ í•˜ëŠ” **ë‹¨ì **ì´ ìˆë‹¤.
- ë”°ë¼ì„œ, ë‘ ê°€ì§€ ì£¼ìš”í•œ ë¬¸ì œë¥¼ ì•¼ê¸°í•œë‹¤.
    1. **ì´ì „ ë‹¨ê³„ì—ì„œ ë°œìƒí•œ ì˜¤ë¥˜ê°€** ëˆ„ì ë˜ì–´ í›„ì†ë‹¨ê³„ì—ì„œ ì¦í­ë˜ì–´ **ìµœì¢… ì„±ëŠ¥ì— í° ì˜í–¥ì„ ë¯¸ì¹¨**
    2. **ë³µì¡í•œ ìˆ˜ì‘ì—… ì—°ì‚°**ì„ í•´ì•¼í•˜ì§€ë§Œ, GPU accelerationìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ì—†ì–´ **ë§ì€ ì‹œê°„ì´ ì†Œìš”**

![[readme04.png]]

**E2FGVI** (ê°œì„ ëœ ëª¨ë¸ Fig. Ours, ) 
- ë¬¸ì œì ì„ ë³´ì™„, ì´ì „ ë°©ë²•ê³¼ ë‹¤ë¥´ê²Œ â€˜ê³µë™ìœ¼ë¡œâ€™(**End-to-End**) ìµœì í™” í•  ìˆ˜ ìˆì–´ ë³´ë‹¤ íš¨ìœ¨ì ì´ê³  íš¨ê³¼ì ì¸ ì¸í˜ì¸íŒ… í”„ë¡œì„¸ìŠ¤ êµ¬í˜„ ê°€ëŠ¥
1. Flow-Completion ëª¨ë“ˆ: ì—¬ëŸ¬ ë³µì¡í•œ ë‹¨ê³„ ëŒ€ì‹  ì›-ìŠ¤í… ì™„ì„±ì„ ìœ„í•´ ë§ˆìŠ¤í‚¹ ëœ ë¹„ë””ì˜¤ì— ì§ì ‘ ì ìš©
2. Feature Propagation ëª¨ë“ˆ: pixel-level propagation ê³¼ëŠ” ë‹¬ë¦¬, flow-guided propagation í”„ë¡œì„¸ìŠ¤ëŠ” (ë³€í˜•ì´ ê°€ëŠ¥í•œ convolutionì˜ ë„ì›€ì„ ë°›ì•„ì„œ) feature space ìˆ˜í–‰ë¨ 
   â†’ í•™ìŠµ ê°€ëŠ¥í•œ sampling offsetê³¼ feature-level ì—°ì‚°ì„ í†µí•´ **ì •í™•í•˜ì§€ ì•Šì€ flowì¶”ì •ì˜ ë¶€ë‹´ì„ ëœì–´ì¤Œ**
3. Content Hallucination ëª¨ë“ˆ: ê³µê°„ê³¼ ì‹œê°„ì  ì°¨ì› ë‘˜ ë‹¤ì—ì„œ ì¥ê±°ë¦¬ ì¢…ì†ì„±ì„ íš¨ê³¼ì ìœ¼ë¡œ ëª¨ë¸ë§í•˜ê¸° ìœ„í•´ temporal focal transformer(ì‹œê°„ì  ì´ˆì  ë³€í™˜ê¸°)ë¥¼ ì œì•ˆ 
   â†’ì´ ëª¨ë“ˆì—ì„œ ë¡œì»¬ ë° ë¹„ë¡œì»¬ ì‹œê°„ì  ì£¼ë³€ ì´ì›ƒ(local and non-local temporal neighbors)ì„ ëª¨ë‘ ê³ ë ¤í•˜ì—¬, **ë³´ë‹¤ ì‹œê°„ì ìœ¼ë¡œ ì¼ê´€ëœ ì¸í˜ì¸íŒ… ê²°ê³¼**ë¥¼ ë„ì¶œ
>
- 70ê°œì˜ í”„ë ˆì„ ê¸°ì¤€ìœ¼ë¡œ ì´ í¬ê¸°ì˜ ë¹„ë””ì˜¤ í•˜ë‚˜ë¥¼ ì™„ì„±í•˜ëŠ” ë°ì— ì•½ 4ë¶„ ì†Œìš”. E2FGVIëŠ” í”„ë ˆì„ë‹¹ 0.12ì´ˆë¡œ ì•½ 8.4ì´ˆ ì†Œìš”.



## Inpainterz PJT Review

### êµ¬ì„±í•œ Appì˜ í•œê³„ì 
- 
- 
### íšŒê³  ë° ê°œì„ ê°€ëŠ¥í•œ ë°©í–¥ë“¤
- 
- 
- 



## Getting Started
-----
ğŸ® 1. Conda Default Environment
```shell
pip install torch==1.11.0+cu113 torchvision==0.12.0+cu113 torchaudio==0.11.0 --extra-index-url https://download.pytorch.org/whl/cu113
pip install mmcv-full==1.4.8 -f https://download.openmmlab.com/mmcv/dist/cu113/torch1.11/index.html
# script > delete opencv-python
# cd /DATA/inpainterz/Inpainterz_Video_Inpainting
bash script/install.sh
pip install gradio==3.39
pip install av
```

ğŸ“‘ 2. Requirements
- The Segment-Anything repository has been cloned and renamed as sam, and the aot benchmark repository has been cloned and renamed as aot.

- Please check the dependency requirements in SAM and DeAOT and E2FGVI.

- The implementation is tested under python 3.9, as well as pytorch 1.11.0+cu113 and torchvision 0.12.0+cu113 We recommend equivalent or higher pytorch version.
  
-  Use the install.sh to install the necessary libs for **Inpainterz**
  ```
  bash script/install.sh
  ```

â­ 3. Model Preparation
- Download **SAM** model to **ckpt**, the default model is SAM-VIT-B (sam_vit_b_01ec64.pth).
  
- Download **DeAOT/AOT** model to **ckpt**, 
  the default model is R50-DeAOT-L (R50_DeAOTL_PRE_YTB_DAV.pth).

- Download **Grounding-Dino** model to **ckpt**, 
  the default model is GroundingDINO-T (groundingdino_swint_ogc).

- Download **E2fgvi** model to **ckpt**, 
  the default model is E2FGVI-CVPR22 (E2FGVI-CVPR22.pth)

- You can download the default weights using the command line as shown below.
  ```
  bash script/download_ckpt.sh
  ```


## License
---------------------
ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ì§€í–¥í•©ë‹ˆë‹¤. 

SAM, DeAOTëŠ” ìƒì—…ì  ì´ìš©ê¹Œì§€ ê°€ëŠ¥í•œ ì˜¤í”ˆì†ŒìŠ¤ì…ë‹ˆë‹¤.

í•˜ì§€ë§Œ E2FGVIëŠ” ìƒì—…ì ìœ¼ë¡œëŠ” ì´ìš©í•  ìˆ˜ ì—†ê¸°ì— ì¶”ê°€í™•ì¸í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.






## Acknowledgement
---------
This repository is maintained byÂ **Inpainterz** [ê°•ë„ì„±]()Â andÂ [ê²½ì†Œí˜„](), [ë³€ì›…ì§„](), [ì†ìˆ˜ì§„](), [ì§€ê²½í˜¸]()

This code is based onÂ [SAM](),Â [DeAOT](),Â [SAMTrack](), andÂ [E2FGVI]().